(window.webpackJsonp=window.webpackJsonp||[]).push([[22,25,26,27,28,29,30,31],{151:function(e,t,r){"use strict";r.d(t,"c",function(){return s}),r.d(t,"b",function(){return b}),r.d(t,"d",function(){return d}),r.d(t,"e",function(){return m}),r.d(t,"a",function(){return h});var n=r(182),o=r.n(n),a=r(496),i=r(170);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=8e3;function s(e){var t=e.slice;return t?t.slice_id:0}var p=0;function f(){var e=0;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(e=p%a.b.length,p+=1),a.b[e]}function b(e,t,r){if(null==e)return null;var n=r?"annotation_json":"slice_json";return o()(window.location.search).pathname("/superset/".concat(n,"/").concat(e)).search({form_data:Object(i.safeStringify)(t,function(e,t){return null===t?void 0:t})}).toString()}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"base",r="/superset/explore/";return["json","csv","query","results","samples"].indexOf(t)>=0&&(r="/superset/explore_json/"),r}function d(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!e.datasource)return null;var a=new o.a("/"),c=y(e,t),u=a.search(!0);Object.keys(n).forEach(function(e){u[e]=n[e]}),u.form_data=Object(i.safeStringify)(e),"standalone"===t&&(u.standalone="true");var s=a.directory(c).search(u).toString();return!r&&s.length>l?d({datasource:e.datasource,viz_type:e.viz_type},t,!1,{URL_IS_TOO_LONG_TO_SHARE:null}):s}function m(e){var t=e.formData,r=e.endpointType,n=void 0===r?"base":r,a=e.force,l=void 0!==a&&a,s=e.curUrl,p=void 0===s?null:s,b=e.requestParams,d=void 0===b?{}:b,m=e.allowDomainSharding,h=void 0!==m&&m,g=e.method,v=void 0===g?"POST":g;if(!t.datasource)return null;var O=new o.a({protocol:location.protocol.slice(0,-1),hostname:f(h),port:location.port?location.port:"",path:"/"});p&&(O=o()(o()(p).search()));var j=y(t,n),w=O.search(!0),_=t.slice_id,P=t.extra_filters,S=t.adhoc_filters,C=t.viz_type;if(_){var k={slice_id:_};"GET"===v&&(k.viz_type=C,P&&P.length&&(k.extra_filters=P),S&&S.length&&(k.adhoc_filters=S)),w.form_data=Object(i.safeStringify)(k)}l&&(w.force="true"),"csv"===n&&(w.csv="true"),"standalone"===n&&(w.standalone="true"),"query"===n&&(w.query="true"),"results"===n&&(w.results="true"),"samples"===n&&(w.samples="true");var E=Object.keys(d);E.length&&E.forEach(function(e){d.hasOwnProperty(e)&&(w[e]=d[e])}),O=O.search(w).directory(j);var D=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(r,!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},t);return{url:O.toString(),payload:D}}function h(e,t){var r=m({formData:e,endpointType:t,allowDomainSharding:!1}),n=r.url,o=r.payload,a=document.createElement("form");a.action=n,a.method="POST",a.target="_blank";var c=document.createElement("input");c.type="hidden",c.name="csrf_token",c.value=(document.getElementById("csrf_token")||{}).value,a.appendChild(c);var u=document.createElement("input");u.type="hidden",u.name="form_data",u.value=Object(i.safeStringify)(o),a.appendChild(u),console.log("121212"),document.body.appendChild(a),a.submit(),document.body.removeChild(a)}},170:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeStringify=function(e){var t=new Set;return JSON.stringify(e,function(e,r){if("object"==typeof r&&null!==r){if(t.has(r))try{return JSON.parse(JSON.stringify(r))}catch(e){return}t.add(r)}return r})}},2100:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(1),o=r.n(n),a=r(2101),i=r.n(a);r(2293),r(2292);function c(e){return o.a.createElement("span",{className:"BootstrapSliderWrapper"},o.a.createElement(i.a,e))}},2292:function(e,t,r){},2713:function(e,t,r){"use strict";r.d(t,"b",function(){return p}),r.d(t,"a",function(){return f}),r.d(t,"c",function(){return y});var n=r(2903),o=r(21),a=r(2716);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=.25,l={LAT_MIN:-90,LAT_MAX:90,LNG_MIN:-180,LNG_MAX:180};function s(e){var t=o.extent(e,function(e){return e[1]}),r=o.extent(e,function(e){return e[0]}),n=t[0]===t[1]?function(e){return[e[0]-u<l.LAT_MIN?l.LAT_MIN:e[0]-u,e[1]+u>l.LAT_MAX?l.LAT_MAX:e[1]+u]}(t):t,a=r[0]===r[1]?function(e){return[e[0]-u<l.LNG_MIN?l.LNG_MIN:e[0]-u,e[1]+u>l.LNG_MAX?l.LNG_MAX:e[1]+u]}(r):r;return[[a[0],n[0]],[a[1],n[1]]]}function p(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{var o=s(t);return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(r,!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e,{},Object(n.a)({height:e.height,width:e.width,padding:r,bounds:o}))}catch(t){return console.error("Could not auto zoom",t),e}}function f(e,t,r,n){var o,i,c=e,u=r;return c.js_tooltip&&(u=Object(a.a)(c.js_tooltip)),u&&(o=function(e){e.picked?t({content:u(e),x:e.x,y:e.y+30}):t(null)}),c.js_onclick_href?i=function(e){var t=Object(a.a)(c.js_onclick_href)(e);window.open(t)}:c.table_filter&&void 0!==n&&(i=function(e){return n(e.object[c.line_column])}),{onClick:i,onHover:o,pickable:Boolean(o)}}var b={p1:.01,p5:.05,p95:.95,p99:.99};function y(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"sum",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"count"===t?function(e){return e.length}:(e=t in b?function(e,n){var a;return a=r?e.sort(function(e,t){return o.ascending(r(e),r(t))}):e.sort(o.ascending),o.quantile(a,b[t],n)}:o[t],r?function(t){return e(t.map(r))}:function(t){return e(t)})}},2716:function(e,t,r){"use strict";r.d(t,"a",function(){return f});var n=r(2745),o=r.n(n),a=r(2746),i=r.n(a),c=r(21),u=r(2717);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var p={console:console,_:i.a,colors:u,d3array:c};function f(e,t,r){var n={},a="SAFE_EVAL_"+Math.floor(1e6*Math.random());n[a]={};var i=a+"="+e,c=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(r,!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},p,{},t);Object.keys(c).forEach(function(e){n[e]=c[e]});try{return o.a.runInNewContext(i,n,r),n[a]}catch(e){return function(){return e}}}},2717:function(e,t,r){"use strict";r.r(t),r.d(t,"hexToRGB",function(){return o});var n=r(100);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;if(!e)return[0,0,0,t];var r=Object(n.f)(e);return[r.r,r.g,r.b,t]}},2721:function(e,t,r){"use strict";r.d(t,"a",function(){return w});var n=r(191),o=r.n(n),a=r(1),i=r.n(a),c=r(0),u=r.n(c),l=r(2740),s=r(2723);r(2741),r(2730);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(r,!0).forEach(function(t){d(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var O=2e3,j={viewport:u.a.object.isRequired,layers:u.a.array.isRequired,setControlValue:u.a.func,mapStyle:u.a.string,mapboxApiAccessToken:u.a.string.isRequired,onViewportChange:u.a.func},w=function(e){function t(e){var r,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(r=!(o=h(t).call(this,e))||"object"!==p(o)&&"function"!=typeof o?g(n):o).tick=r.tick.bind(g(r)),r.onViewportChange=r.onViewportChange.bind(g(r)),r.state={previousViewport:e.viewport,timer:setInterval(r.tick,O)},r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,i.a.Component),r=t,a=[{key:"getDerivedStateFromProps",value:function(e,t){return e.viewport!==t.viewport?{viewport:y({},e.viewport),previousViewport:t.viewport}:null}}],(n=[{key:"componentWillUnmount",value:function(){clearInterval(this.state.timer)}},{key:"onViewportChange",value:function(e){var t=Object.assign({},e),r=y({},this.state.previousViewport,{},t);this.props.onViewportChange(r)}},{key:"tick",value:function(){var e=this;if(this.state&&!o()(this.state.previousViewport,this.props.viewport)){var t=this.props.setControlValue,r=this.props.viewport;t&&t("viewport",r),this.setState(function(){return{previousViewport:e.props.viewport}})}}},{key:"layers",value:function(){return this.props.layers.some(function(e){return"function"==typeof e})?this.props.layers.map(function(e){return"function"==typeof e?e():e}):this.props.layers}},{key:"render",value:function(){var e=this.props.viewport;return i.a.createElement(l.b,f({},e,{mapStyle:this.props.mapStyle,onViewportChange:this.onViewportChange,mapboxApiAccessToken:this.props.mapboxApiAccessToken}),i.a.createElement(s.i,f({},e,{layers:this.layers(),initWebGLParameters:!0})))}}])&&m(r.prototype,n),a&&m(r,a),t}();w.propTypes=j,w.defaultProps={mapStyle:"light",onViewportChange:function(){},setControlValue:function(){}}},2726:function(e,t,r){"use strict";r.d(t,"a",function(){return b});var n=r(1),o=r.n(n),a=r(0),i=r.n(a);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f={label:i.a.string.isRequired,value:i.a.string.isRequired},b=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,s(t).apply(this,arguments))}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,o.a.PureComponent),r=t,(n=[{key:"render",value:function(){return o.a.createElement("div",null,this.props.label,o.a.createElement("strong",null,this.props.value))}}])&&u(r.prototype,n),a&&u(r,a),t}();b.propTypes=f},2730:function(e,t,r){},2731:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r(8),o=r.n(n);function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i=[1,0,1,0,0,0,0];function c(e,t){var r=parseInt(o()(t).format("x"),10);return parseInt(o()(t).add(e).format("x"),10)-r}var u=function(e,t){var r,n,u=o()(Math.min.apply(Math,a(e))),l=o()(Math.max.apply(Math,a(e)));if(-1!==t.indexOf("/")){var s=t.split("/",2);s[0].endsWith("Z")?(n=o()(s[0]),r=o.a.duration(s[1])):(n=o()(s[1]),r=o.a.duration(s[0]))}else n=function(e,t){var r=o()(e).subtract(t),n=e.toArray(),a=r.toArray(),c=n.map(function(e,t){return a[t]!==e}).indexOf(!0),u=n.map(function(e,t){if(t===c){var r=e-a[t];return e-(e-i[t])%r}return t<c||-1===c?e:i[t]});return o()(u)}(u,r=o.a.duration(t));for(var p=o()(n);p<u;)p.add(r);for(;p>u;)p.subtract(r);for(var f=o()(n);f>l;)f.subtract(r);for(;f<l;)f.add(r);var b=null!=t?[p,o()(p).add(r)]:[p,f],y=e.every(function(e){return null===e});return{start:parseInt(p.format("x"),10),end:parseInt(f.format("x"),10),getStep:c.bind(this,r),values:b.map(function(e){return parseInt(e.format("x"),10)}),disabled:y}}},2732:function(e,t,r){"use strict";var n=r(1),o=r.n(n),a=r(0),i=r.n(a),c=r(2721),u=r(1662),l=r.n(u),s=r(26),p=r(2100);r(2734);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h={start:i.a.number.isRequired,step:i.a.number.isRequired,end:i.a.number.isRequired,values:i.a.array.isRequired,onChange:i.a.func,loopDuration:i.a.number,maxFrames:i.a.number,orientation:i.a.oneOf(["horizontal","vertical"]),reversed:i.a.bool,disabled:i.a.bool,range:i.a.bool},g=function(e){function t(e){var r,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(r=!(o=y(t).call(this,e))||"object"!==f(o)&&"function"!=typeof o?d(n):o).state={intervalId:null};var a=e.end-e.start,i=Math.min(e.maxFrames,a/e.step),c=a/i;return r.intervalMilliseconds=e.loopDuration/i,r.increment=c<e.step?e.step:c-c%e.step,r.onChange=r.onChange.bind(d(r)),r.play=r.play.bind(d(r)),r.pause=r.pause.bind(d(r)),r.stepBackward=r.stepBackward.bind(d(r)),r.stepForward=r.stepForward.bind(d(r)),r.getPlayClass=r.getPlayClass.bind(d(r)),r.formatter=r.formatter.bind(d(r)),r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,o.a.PureComponent),r=t,(n=[{key:"componentDidMount",value:function(){l.a.bind(["space"],this.play)}},{key:"componentWillUnmount",value:function(){l.a.unbind(["space"])}},{key:"onChange",value:function(e){this.props.onChange(e.target.value),null!=this.state.intervalId&&this.pause()}},{key:"getPlayClass",value:function(){return null==this.state.intervalId?"fa fa-play fa-lg slider-button":"fa fa-pause fa-lg slider-button"}},{key:"play",value:function(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{var e=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:e})}}},{key:"pause",value:function(){clearInterval(this.state.intervalId),this.setState({intervalId:null})}},{key:"stepForward",value:function(){var e=this,t=this.props,r=t.start,n=t.end,o=t.step,a=t.values;if(!t.disabled){var i=(Array.isArray(a)?a:[a,a+o]).map(function(t){return t+e.increment}),c=i[1]>n?i[0]-r:0;this.props.onChange(i.map(function(e){return e-c}))}}},{key:"stepBackward",value:function(){var e=this,t=this.props,r=t.start,n=t.end,o=t.step,a=t.values;if(!t.disabled){var i=(Array.isArray(a)?a:[a,a+o]).map(function(t){return t-e.increment}),c=i[0]<r?n-i[1]:0;this.props.onChange(i.map(function(e){return e+c}))}}},{key:"formatter",value:function(e){if(this.props.disabled)return Object(s.b)("Data has no time steps");var t=e;return Array.isArray(e)?e[0]===e[1]&&(t=[e[0]]):t=[e],t.map(function(e){return new Date(e).toUTCString()}).join(" : ")}},{key:"render",value:function(){var e=this.props,t=e.start,r=e.end,n=e.step,a=e.orientation,i=e.reversed,c=e.disabled,u=e.range,l=e.values;return o.a.createElement("div",{className:"play-slider"},o.a.createElement("div",{className:"play-slider-controls padded"},o.a.createElement("i",{className:"fa fa-step-backward fa-lg slider-button ",onClick:this.stepBackward}),o.a.createElement("i",{className:this.getPlayClass(),onClick:this.play}),o.a.createElement("i",{className:"fa fa-step-forward fa-lg slider-button ",onClick:this.stepForward})),o.a.createElement("div",{className:"play-slider-scrobbler padded"},o.a.createElement(p.a,{value:u?l:l[0],range:u,formatter:this.formatter,change:this.onChange,min:t,max:r,step:n,orientation:a,reversed:i,disabled:c?"disabled":"enabled"})))}}])&&b(r.prototype,n),a&&b(r,a),t}();function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(r,!0).forEach(function(t){w(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}g.propTypes=h,g.defaultProps={onChange:function(){},loopDuration:15e3,maxFrames:100,orientation:"horizontal",reversed:!1,disabled:!1,range:!0},r.d(t,"a",function(){return E});var k={getLayers:i.a.func.isRequired,start:i.a.number.isRequired,end:i.a.number.isRequired,getStep:i.a.func,values:i.a.array.isRequired,aggregation:i.a.bool,disabled:i.a.bool,viewport:i.a.object.isRequired,children:i.a.node,mapStyle:i.a.string,mapboxApiAccessToken:i.a.string.isRequired,setControlValue:i.a.func,onViewportChange:i.a.func,onValuesChange:i.a.func},E=function(e){function t(e){var r,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(r=!(o=P(t).call(this,e))||"object"!==v(o)&&"function"!=typeof o?S(n):o).onViewportChange=r.onViewportChange.bind(S(r)),r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(t,o.a.Component),r=t,(n=[{key:"onViewportChange",value:function(e){var t=this.props.disabled?j({},e):j({},e,{height:e.height+20});this.props.onViewportChange(t)}},{key:"render",value:function(){var e=this.props,t=e.start,r=e.end,n=e.getStep,a=e.disabled,i=e.aggregation,u=e.children,l=e.getLayers,s=e.values,p=e.onValuesChange,f=e.viewport,b=e.setControlValue,y=e.mapStyle,d=e.mapboxApiAccessToken,m=l(s),h=j({},f,{height:a?f.height:f.height-20});return o.a.createElement("div",null,o.a.createElement(c.a,{viewport:h,layers:m,setControlValue:b,mapStyle:y,mapboxApiAccessToken:d,onViewportChange:this.onViewportChange}),!a&&o.a.createElement(g,{start:t,end:r,step:n(t),values:s,range:!i,onChange:p}),u)}}])&&_(r.prototype,n),a&&_(r,a),t}();E.propTypes=k,E.defaultProps={aggregation:!1,disabled:!1,mapStyle:"light",setControlValue:function(){},onViewportChange:function(){},onValuesChange:function(){}}},2734:function(e,t,r){},2735:function(e,t,r){"use strict";var n=r(191),o=r.n(n),a=r(1),i=r.n(a),c=r(0),u=r.n(c),l=r(2721),s=r(142),p=r(2732),f=r(2736),b=r(2717),y=r(2731),d=r(2716),m=r(2713);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(r,!0).forEach(function(t){j(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=s.CategoricalColorNamespace.getScale;var k={formData:u.a.object.isRequired,mapboxApiKey:u.a.string.isRequired,setControlValue:u.a.func.isRequired,viewport:u.a.object.isRequired,getLayer:u.a.func.isRequired,getPoints:u.a.func.isRequired,payload:u.a.object.isRequired,onAddFilter:u.a.func,setTooltip:u.a.func},E=function(e){function t(e){var r,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(r=!(o=_(t).call(this,e))||"object"!==h(o)&&"function"!=typeof o?P(n):o).state=r.getStateFromProps(e),r.getLayers=r.getLayers.bind(P(r)),r.onValuesChange=r.onValuesChange.bind(P(r)),r.onViewportChange=r.onViewportChange.bind(P(r)),r.toggleCategory=r.toggleCategory.bind(P(r)),r.showSingleCategory=r.showSingleCategory.bind(P(r)),r}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,i.a.PureComponent),r=t,(n=[{key:"componentWillReceiveProps",value:function(e){e.payload.form_data!==this.state.formData&&this.setState(O({},this.getStateFromProps(e)))}},{key:"onValuesChange",value:function(e){this.setState({values:Array.isArray(e)?e:[e,e+this.state.getStep(e)]})}},{key:"onViewportChange",value:function(e){this.setState({viewport:e})}},{key:"getStateFromProps",value:function(e,t){var r=e.payload.data.features||[],n=r.map(function(e){return e.__timestamp}),o=function(e,t){var r=e.color_picker||{r:0,g:0,b:0,a:1},n=[r.r,r.g,r.b,255*r.a],o=C(e.color_scheme),a={};return t.forEach(function(t){var i;null==t.cat_color||a.hasOwnProperty(t.cat_color)||(i=e.dimension?Object(b.hexToRGB)(o(t.cat_color),255*r.a):n,a[t.cat_color]={color:i,enabled:!0})}),a}(e.formData,r);if(t&&e.payload.form_data===t.formData)return O({},t,{categories:o});var a=e.payload.form_data.time_grain_sqla||e.payload.form_data.granularity||"P1D",i=Object(y.a)(n,a);return{start:i.start,end:i.end,getStep:i.getStep,values:i.values,disabled:i.disabled,viewport:e.formData.autozoom?Object(m.b)(e.viewport,e.getPoints(r)):e.viewport,selected:[],lastClick:0,formData:e.payload.form_data,categories:o}}},{key:"getLayers",value:function(e){var t=this.props,r=t.getLayer,n=t.payload,o=t.formData,a=t.onAddFilter,i=t.setTooltip,c=n.data.features?g(n.data.features):[];(c=this.addColor(c,o),o.js_data_mutator)&&(c=Object(d.a)(o.js_data_mutator)(c));c=e[0]===e[1]||e[1]===this.end?c.filter(function(t){return t.__timestamp>=e[0]&&t.__timestamp<=e[1]}):c.filter(function(t){return t.__timestamp>=e[0]&&t.__timestamp<e[1]});var u=this.state.categories;return o.dimension&&(c=c.filter(function(e){return u[e.cat_color]&&u[e.cat_color].enabled})),[r(o,O({},n,{data:O({},n.data,{features:c})}),a,i)]}},{key:"addColor",value:function(e,t){var r=t.color_picker||{r:0,g:0,b:0,a:1},n=C(t.color_scheme);return e.map(function(e){return t.dimension?O({},e,{color:Object(b.hexToRGB)(n(e.cat_color),255*r.a)}):e})}},{key:"toggleCategory",value:function(e){var t=this.state.categories[e],r=O({},this.state.categories,j({},e,O({},t,{enabled:!t.enabled})));Object.values(r).every(function(e){return!e.enabled})&&Object.values(r).forEach(function(e){e.enabled=!0}),this.setState({categories:r})}},{key:"showSingleCategory",value:function(e){var t=O({},this.state.categories);Object.values(t).forEach(function(e){e.enabled=!1}),t[e].enabled=!0,this.setState({categories:t})}},{key:"render",value:function(){return i.a.createElement("div",{style:{position:"relative"}},i.a.createElement(p.a,{getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,onValuesChange:this.onValuesChange,disabled:this.state.disabled,viewport:this.state.viewport,onViewportChange:this.onViewportChange,mapboxApiAccessToken:this.props.mapboxApiKey,mapStyle:this.props.formData.mapbox_style,setControlValue:this.props.setControlValue},i.a.createElement(f.a,{categories:this.state.categories,toggleCategory:this.toggleCategory,showSingleCategory:this.showSingleCategory,position:this.props.formData.legend_position})))}}])&&w(r.prototype,n),o&&w(r,o),t}();function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(r,!0).forEach(function(t){V(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}E.propTypes=k,r.d(t,"b",function(){return I}),r.d(t,"a",function(){return N});var F={formData:u.a.object.isRequired,payload:u.a.object.isRequired,setControlValue:u.a.func.isRequired,viewport:u.a.object.isRequired,onAddFilter:u.a.func,setTooltip:u.a.func},M={onAddFilter:function(){},setTooltip:function(){}};function I(e,t){var r=function(r){function n(e){var r,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),o=this,r=!(a=L(n).call(this,e))||"object"!==D(a)&&"function"!=typeof a?R(o):a;var i=e.viewport,c=e.formData.autozoom?Object(m.b)(i,t(e.payload.data.features)):i;return r.state={viewport:c,layer:r.computeLayer(e)},r.onViewportChange=r.onViewportChange.bind(R(r)),r}var a,c,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(n,i.a.PureComponent),a=n,(c=[{key:"componentWillReceiveProps",value:function(e){var t=x({},e.formData,{viewport:null}),r=x({},this.props.formData,{viewport:null});o()(t,r)&&e.payload===this.props.payload||this.setState({layer:this.computeLayer(e)})}},{key:"onViewportChange",value:function(e){this.setState({viewport:e})}},{key:"computeLayer",value:function(t){var r=t.formData,n=t.payload,o=t.onAddFilter,a=t.setTooltip;return e(r,n,o,a)}},{key:"render",value:function(){var e=this.props,t=e.formData,r=e.payload,n=e.setControlValue,o=this.state,a=o.layer,c=o.viewport;return i.a.createElement(l.a,{mapboxApiAccessToken:r.data.mapboxApiKey,viewport:c,layers:[a],mapStyle:t.mapbox_style,setControlValue:n,onViewportChange:this.onViewportChange})}}])&&T(a.prototype,c),u&&T(a,u),n}();return r.propTypes=F,r.defaultProps=M,r}function N(e,t){function r(r){var n=r.formData,o=r.payload,a=r.setControlValue,c=r.onAddFilter,u=r.setTooltip,l=r.viewport;return i.a.createElement(E,{formData:n,mapboxApiKey:o.data.mapboxApiKey,setControlValue:a,viewport:l,getLayer:e,payload:o,onAddFilter:c,setTooltip:u,getPoints:t})}return r.propTypes=F,r.defaultProps=M,r}},2736:function(e,t,r){"use strict";r.d(t,"a",function(){return d});var n=r(1),o=r.n(n),a=r(0),i=r.n(a);r(2737);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y={categories:i.a.object,toggleCategory:i.a.func,showSingleCategory:i.a.func,position:i.a.oneOf([null,"tl","tr","bl","br"])},d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,f(t).apply(this,arguments))}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,o.a.PureComponent),r=t,(n=[{key:"render",value:function(){var e,t=this;if(0===Object.keys(this.props.categories).length||null===this.props.position)return null;var r=Object.entries(this.props.categories).map(function(e){var r=l(e,2),n=r[0],a=r[1],i={color:"rgba("+a.color.join(", ")+")"},c=a.enabled?"◼":"◻";return o.a.createElement("li",{key:n},o.a.createElement("a",{href:"#",onClick:function(){return t.props.toggleCategory(n)},onDoubleClick:function(){return t.props.showSingleCategory(n)}},o.a.createElement("span",{style:i},c)," ",n))}),n="t"===this.props.position.charAt(0)?"top":"bottom",a="r"===this.props.position.charAt(1)?"right":"left",i=(u(e={position:"absolute"},n,"0px"),u(e,a,"10px"),e);return o.a.createElement("div",{className:"legend",style:i},o.a.createElement("ul",{className:"categories"},r))}}])&&s(r.prototype,n),a&&s(r,a),t}();d.propTypes=y,d.defaultProps={categories:{},toggleCategory:function(){},showSingleCategory:function(){},position:"tr"}},2737:function(e,t,r){},2742:function(e,t){},2743:function(e,t){},2744:function(e,t){},2795:function(e,t,r){"use strict";r.r(t),r.d(t,"getLayer",function(){return f});var n=r(2723),o=r(1),a=r.n(o),i=r(26),c=r(2713),u=r(2735),l=r(2726);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t,r,o){var u,f=t.data.features,b=e.color_picker,y=e.target_color_picker;return new n.a(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(r,!0).forEach(function(t){p(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({id:"path-layer-".concat(e.slice_id),data:f,getSourceColor:function(e){return e.sourceColor||e.color||[b.r,b.g,b.b,255*b.a]},getTargetColor:function(e){return e.targetColor||e.color||[y.r,y.g,y.b,255*y.a]},strokeWidth:e.stroke_width?e.stroke_width:3},Object(c.a)(e,o,(u=e,function(e){return a.a.createElement("div",{className:"deckgl-tooltip"},a.a.createElement(l.a,{label:"".concat(Object(i.b)("Start (Longitude, Latitude)"),": "),value:"".concat(e.object.sourcePosition[0],", ").concat(e.object.sourcePosition[1])}),a.a.createElement(l.a,{label:"".concat(Object(i.b)("End (Longitude, Latitude)"),": "),value:"".concat(e.object.targetPosition[0],", ").concat(e.object.targetPosition[1])}),u.dimension&&a.a.createElement(l.a,{label:"".concat(u.dimension,": "),value:"".concat(e.object.cat_color)}))}))))}t.default=Object(u.a)(f,function(e){var t=[];return e.forEach(function(e){t.push(e.sourcePosition),t.push(e.targetPosition)}),t})},2817:function(e,t,r){"use strict";r.r(t),r.d(t,"getLayer",function(){return j});var n=r(1),o=r.n(n),a=r(0),i=r.n(a),c=r(2723),u=r(2721),l=r(2717),s=r(2716),p=r(2713),f=r(2726);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(r,!0).forEach(function(t){d(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m,h={fillColor:"fillColor",color:"fillColor",fill:"fillColor","fill-color":"fillColor",strokeColor:"strokeColor","stroke-color":"strokeColor","stroke-width":"strokeWidth"},g=function(e,t){var r={};return Object.keys(e).forEach(function(t){t in h?r[h[t]]=e[t]:r[t]=e[t]}),"string"==typeof e.fillColor&&(r.fillColor=Object(l.hexToRGB)(e.fillColor)),"string"==typeof e.strokeColor&&(r.strokeColor=Object(l.hexToRGB)(e.strokeColor)),y({},r,{},t)},v=function e(t,r,n){if(t&&t.features&&t.features.forEach(function(o){e(o,r,t.extraProps||n)}),t&&t.geometry){var o=y({},t,{properties:g(t.properties,r)});o.extraProps||(o.extraProps=n),m.push(o)}};function O(e){return e.object.extraProps&&o.a.createElement("div",{className:"deckgl-tooltip"},Object.keys(e.object.extraProps).map(function(t,r){return o.a.createElement(f.a,{key:"prop-".concat(r),label:"".concat(t,": "),value:"".concat(e.object.extraProps[t])})}))}function j(e,t,r,n){var o,a=e,i=a.fill_color_picker,u=a.stroke_color_picker,l=[i.r,i.g,i.b,255*i.a],f=[u.r,u.g,u.b,255*u.a],b={};return l[3]>0&&(b.fillColor=l),f[3]>0&&(b.strokeColor=f),m=[],v(t.data,b),a.js_data_mutator&&(o=Object(s.a)(a.js_data_mutator),m=o(m)),new c.b(y({id:"geojson-layer-".concat(a.slice_id),filled:a.filled,data:m,stroked:a.stroked,extruded:a.extruded,pointRadiusScale:a.point_radius_scale},Object(p.a)(a,n,O)))}var w={formData:i.a.object.isRequired,payload:i.a.object.isRequired,setControlValue:i.a.func.isRequired,viewport:i.a.object.isRequired,onAddFilter:i.a.func,setTooltip:i.a.func};function _(e){var t=e.formData,r=e.payload,n=e.setControlValue,a=(e.onAddFilter,e.setTooltip),i=e.viewport,c=j(t,r,0,a);return o.a.createElement(u.a,{mapboxApiAccessToken:r.data.mapboxApiKey,viewport:i,layers:[c],mapStyle:t.mapbox_style,setControlValue:n})}_.propTypes=w,_.defaultProps={onAddFilter:function(){},setTooltip:function(){}},t.default=_},2818:function(e,t,r){"use strict";r.r(t),r.d(t,"getLayer",function(){return d});var n=r(2723),o=r(1),a=r.n(o),i=r(26),c=r(2713),u=r(2716),l=r(2735),s=r(2726);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(r,!0).forEach(function(t){b(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e){return a.a.createElement("div",{className:"deckgl-tooltip"},a.a.createElement(s.a,{label:"".concat(Object(i.b)("Longitude and Latitude"),": "),value:"".concat(e.object.position[0],", ").concat(e.object.position[1])}),a.a.createElement(s.a,{label:"".concat(Object(i.b)("Height"),": "),value:"".concat(e.object.elevationValue)}))}function d(e,t,r,o){var a=e,i=a.color_picker,l=t.data.features.map(function(e){return f({},e,{color:[i.r,i.g,i.b,255*i.a]})});a.js_data_mutator&&(l=Object(u.a)(a.js_data_mutator)(l));var s=Object(c.c)(a.js_agg_function,function(e){return e.weight});return new n.c(f({id:"grid-layer-".concat(a.slice_id),data:l,pickable:!0,cellSize:a.grid_size,minColor:[0,0,0,0],extruded:a.extruded,maxColor:[i.r,i.g,i.b,255*i.a],outline:!1,getElevationValue:s,getColorValue:s},Object(c.a)(a,o,y)))}t.default=Object(l.b)(d,function(e){return e.map(function(e){return e.position})})},2819:function(e,t,r){"use strict";r.r(t),r.d(t,"getLayer",function(){return d});var n=r(2723),o=r(1),a=r.n(o),i=r(26),c=r(2713),u=r(2716),l=r(2735),s=r(2726);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(r,!0).forEach(function(t){b(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e){return a.a.createElement("div",{className:"deckgl-tooltip"},a.a.createElement(s.a,{label:"".concat(Object(i.b)("Centroid (Longitude and Latitude)"),": "),value:"(".concat(e.object.centroid[0],", ").concat(e.object.centroid[1],")")}),a.a.createElement(s.a,{label:"".concat(Object(i.b)("Height"),": "),value:"".concat(e.object.elevationValue)}))}function d(e,t,r,o){var a=e,i=a.color_picker,l=t.data.features.map(function(e){return f({},e,{color:[i.r,i.g,i.b,255*i.a]})});a.js_data_mutator&&(l=Object(u.a)(a.js_data_mutator)(l));var s=Object(c.c)(a.js_agg_function,function(e){return e.weight});return new n.d(f({id:"hex-layer-".concat(a.slice_id),data:l,pickable:!0,radius:a.grid_size,minColor:[0,0,0,0],extruded:a.extruded,maxColor:[i.r,i.g,i.b,255*i.a],outline:!1,getElevationValue:s,getColorValue:s},Object(c.a)(a,o,y)))}t.default=Object(l.b)(d,function(e){return e.map(function(e){return e.position})})},2820:function(e,t,r){"use strict";r.r(t),r.d(t,"getLayer",function(){return _});var n=r(1),o=r.n(n),a=r(0),i=r.n(a),c=r(2723),u=r(26),l=r(2732),s=r(2731),p=r(2716),f=r(2713),b=r(2726);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(r,!0).forEach(function(t){j(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e){return o.a.createElement("div",{className:"deckgl-tooltip"},o.a.createElement(b.a,{label:"".concat(Object(u.b)("Longitude and Latitude"),": "),value:"".concat(e.object.position[0],", ").concat(e.object.position[1])}),o.a.createElement(b.a,{label:"".concat(Object(u.b)("Weight"),": "),value:"".concat(e.object.weight)}))}function _(e,t,r,n,o,a,i){var u=e,l=u.color_picker,s=t.data.features.map(function(e){return O({},e,{color:[l.r,l.g,l.b,255*l.a]})});if(u.js_data_mutator){var b=Object(p.a)(u.js_data_mutator);s=b(s)}return null!=i&&i.forEach(function(e){s=s.filter(e)}),new c.h(O({id:"screengrid-layer-".concat(u.slice_id),data:s,pickable:!0,cellSizePixels:u.grid_size,minColor:[l.r,l.g,l.b,0],maxColor:[l.r,l.g,l.b,255*l.a],outline:!1,getWeight:function(e){return e.weight||0}},Object(f.a)(u,n,w)))}var P={formData:i.a.object.isRequired,payload:i.a.object.isRequired,setControlValue:i.a.func.isRequired,viewport:i.a.object.isRequired,onAddFilter:i.a.func,setTooltip:i.a.func},S=function(e){function t(e){var r,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(r=!(o=m(t).call(this,e))||"object"!==y(o)&&"function"!=typeof o?h(n):o).state=t.getDerivedStateFromProps(e),r.getLayers=r.getLayers.bind(h(r)),r.onValuesChange=r.onValuesChange.bind(h(r)),r.onViewportChange=r.onViewportChange.bind(h(r)),r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,o.a.PureComponent),r=t,a=[{key:"getDerivedStateFromProps",value:function(e,t){if(t&&e.payload.form_data===t.formData)return null;var r=e.payload.data.features||[],n=r.map(function(e){return e.__timestamp}),o=e.payload.form_data.time_grain_sqla||e.payload.form_data.granularity||"P1D",a=Object(s.a)(n,o);return{start:a.start,end:a.end,getStep:a.getStep,values:a.values,disabled:a.disabled,viewport:e.formData.autozoom?Object(f.b)(e.viewport,r.map(function(e){return e.position})):e.viewport,selected:[],lastClick:0,formData:e.payload.form_data}}}],(n=[{key:"onValuesChange",value:function(e){this.setState({values:Array.isArray(e)?e:[e,e+this.state.getStep(e)]})}},{key:"onViewportChange",value:function(e){this.setState({viewport:e})}},{key:"getLayers",value:function(e){var t=[];return e[0]===e[1]||e[1]===this.end?t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<=e[1]}):t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<e[1]}),[_(this.props.formData,this.props.payload,this.props.onAddFilter,this.props.setTooltip)]}},{key:"render",value:function(){var e=this.props,t=e.formData,r=e.payload,n=e.setControlValue;return o.a.createElement("div",null,o.a.createElement(l.a,{getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,onValuesChange:this.onValuesChange,disabled:this.state.disabled,viewport:this.state.viewport,onViewportChange:this.onViewportChange,mapboxApiAccessToken:r.data.mapboxApiKey,mapStyle:t.mapbox_style,setControlValue:n,aggregation:!0}))}}])&&d(r.prototype,n),a&&d(r,a),t}();S.propTypes=P,S.defaultProps={onAddFilter:function(){},setTooltip:function(){}},t.default=S},2821:function(e,t,r){"use strict";r.r(t),r.d(t,"getLayer",function(){return y});var n=r(2723),o=r(1),a=r.n(o),i=r(2713),c=r(2716),u=r(2735),l=r(2726);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(r,!0).forEach(function(t){f(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){return e.object.extraProps&&a.a.createElement("div",{className:"deckgl-tooltip"},Object.keys(e.object.extraProps).map(function(t,r){return a.a.createElement(l.a,{key:"prop-".concat(r),label:"".concat(t,": "),value:"".concat(e.object.extraProps[t])})}))}function y(e,t,r,o){var a=e,u=a.color_picker,l=[u.r,u.g,u.b,255*u.a],s=t.data.features.map(function(e){return p({},e,{path:e.path,width:a.line_width,color:l})});a.js_data_mutator&&(s=Object(c.a)(a.js_data_mutator)(s));return new n.e(p({id:"path-layer-".concat(a.slice_id),data:s,rounded:!0,widthScale:1},Object(i.a)(a,o,b)))}t.default=Object(u.b)(y,function(e){var t=[];return e.forEach(function(e){t=t.concat(e.path)}),t})},2822:function(e,t,r){"use strict";r.r(t),r.d(t,"getLayer",function(){return y});var n=r(2723),o=r(1),a=r.n(o),i=r(26),c=r(2713),u=r(2735),l=r(2726),s=r(935);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(r,!0).forEach(function(t){b(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e,t,r,o){var u=e,p=t.data.features.map(function(e){var t=Object(s.b)(u.point_unit,e.radius)||10;if(u.multiplier&&(t*=u.multiplier),e.color)return f({},e,{radius:t});var r=u.color_picker||{r:0,g:0,b:0,a:1};return f({},e,{radius:t,color:[r.r,r.g,r.b,255*r.a]})});return new n.g(f({id:"scatter-layer-".concat(u.slice_id),data:p,fp64:!0,radiusMinPixels:u.min_radius||null,radiusMaxPixels:u.max_radius||null,outline:!1},Object(c.a)(u,o,function(e){return function(t){return a.a.createElement("div",{className:"deckgl-tooltip"},a.a.createElement(l.a,{label:"".concat(Object(i.b)("Longitude and Latitude"),": "),value:"".concat(t.object.position[0],", ").concat(t.object.position[1])}),t.object.cat_color&&a.a.createElement(l.a,{label:"".concat(Object(i.b)("Category"),": "),value:"".concat(t.object.cat_color)}),t.object.metric&&a.a.createElement(l.a,{label:"".concat(e.point_radius_fixed.value.label,": "),value:"".concat(t.object.metric)}))}}(u))))}t.default=Object(u.a)(y,function(e){return e.map(function(e){return e.position})})},2841:function(e,t,r){"use strict";r.r(t);var n=r(1),o=r.n(n),a=r(0),i=r.n(a),c=r(2723),u=r(2732),l=r(2736),s=r(2726),p=r(21),f=r(124),b=r(497),y=r(981),d=r(2717);function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var g=10;function v(e,t,r){var n=e.break_points,o=e.num_buckets;if(!t)return[];if(void 0===n||0===n.length){var a=o?parseInt(o,10):g,i=h(Object(p.extent)(t,r),2),c=i[0],u=i[1];if(void 0===c)return[];var l=(u-c)/a,s=0===l?0:Math.max(0,Math.ceil(Math.log10(1/l))),f=u>u.toFixed(s)?1:0;return Array(a+1+f).fill().map(function(e,t){return(c+t*l).toFixed(s)})}return n.sort(function(e,t){return parseFloat(e)-parseFloat(t)})}function O(e,t,r){var n,o,a=e.break_points,i=e.num_buckets,c=e.linear_color_scheme,u=e.opacity,l=a||i?v({break_points:a,num_buckets:i},t,r):null,s=Array.isArray(c)?new b.a({id:"custom",colors:c}):Object(y.a)().get(c);if(null!==l){var m=l.length-1,h=m>1?s.getColors(m):[s.colors[s.colors.length-1]],g=h[0],O=h[h.length-1];h.unshift(g),h.push(O);var j=l.map(function(e){return parseFloat(e)});n=Object(f.j)().domain(j).range(h),o=function(e){return e>l[m]||e<l[0]}}else n=s.createLinearScale(Object(p.extent)(t,r)),o=function(){return!1};return function(e){var t=r(e),a=Object(d.hexToRGB)(n(t));return o(t)?a[3]=0:a[3]=u/100*255,a}}var j=r(2713),w=r(2731),_=r(2716);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r.d(t,"getLayer",function(){return V});function V(e,t,r,n,a,i,u){var l=e,p=l.fill_color_picker,f=l.stroke_color_picker,b=x(t.data.features);if(null!=u&&u.forEach(function(e){b=b.filter(e)}),l.js_data_mutator){var y=Object(_.a)(l.js_data_mutator);b=y(b)}var d=l.metric?l.metric.label||l.metric:null,m=null===l.metric?function(){return[p.r,p.g,p.b,255*p.a]}:O(l,b,function(e){return e[d]}),h=function(e){var t=m(e);return a.length>0&&-1===a.indexOf(e[l.line_column])&&(t[3]/=2),t},g=l.line_column&&l.metric&&["geohash","zipcode"].indexOf(l.line_type)>=0?function(e){return function(t){var r=e.metric.label||e.metric;return o.a.createElement("div",{className:"deckgl-tooltip"},o.a.createElement(s.a,{label:"".concat(e.line_column,": "),value:"".concat(t.object[e.line_column])}),e.metric&&o.a.createElement(s.a,{label:"".concat(r,": "),value:"".concat(t.object[r])}))}}(l):void 0;return new c.f(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(r,!0).forEach(function(t){A(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({id:"path-layer-".concat(l.slice_id),data:b,pickable:!0,filled:l.filled,stroked:l.stroked,getPolygon:function(e){return e.polygon},getFillColor:h,getLineColor:[f.r,f.g,f.b,255*f.a],getLineWidth:l.line_width,extruded:l.extruded,getElevation:function(e){return function(e,t){return 0===t(e)[3]?0:e.elevation}(e,h)},elevationScale:l.multiplier,fp64:!0},Object(j.a)(l,n,g,i)))}var T={formData:i.a.object.isRequired,payload:i.a.object.isRequired,setControlValue:i.a.func.isRequired,viewport:i.a.object.isRequired,onAddFilter:i.a.func,setTooltip:i.a.func},L=function(e){function t(e){var r,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(r=!(o=C(t).call(this,e))||"object"!==P(o)&&"function"!=typeof o?k(n):o).state=t.getDerivedStateFromProps(e),r.getLayers=r.getLayers.bind(k(r)),r.onSelect=r.onSelect.bind(k(r)),r.onValuesChange=r.onValuesChange.bind(k(r)),r.onViewportChange=r.onViewportChange.bind(k(r)),r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,o.a.Component),r=t,a=[{key:"getDerivedStateFromProps",value:function(e,t){if(t&&e.payload.form_data===t.formData)return null;var r=e.payload.data.features||[],n=r.map(function(e){return e.__timestamp}),o=e.payload.form_data.time_grain_sqla||e.payload.form_data.granularity||"P1D",a=Object(w.a)(n,o);return{start:a.start,end:a.end,getStep:a.getStep,values:a.values,disabled:a.disabled,viewport:e.formData.autozoom?Object(j.b)(e.viewport,function(e){return e.map(function(e){return e.polygon}).flat()}(r)):e.viewport,selected:[],lastClick:0,formData:e.payload.form_data}}}],(n=[{key:"onSelect",value:function(e){var t=this.props,r=t.formData,n=t.onAddFilter,o=new Date,a=o-this.state.lastClick<=250,i=x(this.state.selected);if(a)i.splice(0,i.length,e);else if(r.toggle_polygons){var c=i.indexOf(e);-1===c?i.push(e):i.splice(c,1)}else i.splice(0,1,e);this.setState({selected:i,lastClick:o}),r.table_filter&&n(r.line_column,i,!1,!0)}},{key:"onValuesChange",value:function(e){this.setState({values:Array.isArray(e)?e:[e,e+this.state.getStep(e)]})}},{key:"onViewportChange",value:function(e){this.setState({viewport:e})}},{key:"getLayers",value:function(e){if(void 0===this.props.payload.data.features)return[];var t=[];return e[0]===e[1]||e[1]===this.end?t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<=e[1]}):t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<e[1]}),[V(this.props.formData,this.props.payload,this.props.onAddFilter,this.props.setTooltip,this.state.selected,this.onSelect,t)]}},{key:"render",value:function(){var e=this.props,t=e.payload,r=e.formData,n=e.setControlValue,a=this.state,i=a.start,c=a.end,s=a.getStep,p=a.values,f=a.disabled,b=a.viewport,y=r,d=y.metric?y.metric.label||y.metric:null,h=function(e,t,r){var n=v(e,t,r),o=O(e,t,r),a={};return n.slice(1).forEach(function(t,r){var i=n[r]+" - "+n[r+1],c=.5*(parseFloat(n[r])+parseFloat(n[r+1])),u=e.metric?e.metric.label||e.metric:null;a[i]={color:o(m({},u||e.metric,c)),enabled:!0}}),a}(r,t.data.features,function(e){return e[d]});return o.a.createElement("div",{style:{position:"relative"}},o.a.createElement(u.a,{getLayers:this.getLayers,start:i,end:c,getStep:s,values:p,onValuesChange:this.onValuesChange,disabled:f,viewport:b,onViewportChange:this.onViewportChange,mapboxApiAccessToken:t.data.mapboxApiKey,mapStyle:r.mapbox_style,setControlValue:n,aggregation:!0},null!==r.metric&&o.a.createElement(l.a,{categories:h,position:r.legend_position})))}}])&&S(r.prototype,n),a&&S(r,a),t}();L.propTypes=T,L.defaultProps={onAddFilter:function(){},setTooltip:function(){}};t.default=L},3065:function(e,t,r){"use strict";r.r(t);var n=r(191),o=r.n(n),a=r(1),i=r.n(a),c=r(0),u=r.n(c),l=r(132),s=r(2721),p=r(151),f=r(2818),b=r(2820),y=r(2821),d=r(2819),m=r(2822),h=r(2817),g=r(2795),v=r(2841),O={deck_grid:f.getLayer,deck_screengrid:b.getLayer,deck_path:y.getLayer,deck_hex:d.getLayer,deck_scatter:m.getLayer,deck_geojson:h.getLayer,deck_arc:g.getLayer,deck_polygon:v.getLayer};function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(r,!0).forEach(function(t){P(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var A={formData:u.a.object.isRequired,payload:u.a.object.isRequired,setControlValue:u.a.func.isRequired,viewport:u.a.object.isRequired,onAddFilter:u.a.func,setTooltip:u.a.func,onSelect:u.a.func},x=function(e){function t(e){var r,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(r=!(o=k(t).call(this,e))||"object"!==j(o)&&"function"!=typeof o?E(n):o).state={subSlicesLayers:{}},r.onViewportChange=r.onViewportChange.bind(E(r)),r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(t,i.a.PureComponent),r=t,(n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.formData,r=e.payload;this.loadLayers(t,r)}},{key:"componentWillReceiveProps",value:function(e){var t=e.formData,r=e.payload;!o()(this.props.formData.deck_slices,e.formData.deck_slices)&&this.loadLayers(t,r)}},{key:"onViewportChange",value:function(e){this.setState({viewport:e})}},{key:"loadLayers",value:function(e,t,r){var n=this;this.setState({subSlicesLayers:{},viewport:r}),t.data.slices.forEach(function(t){var r=[].concat(S(t.form_data.filters||[]),S(e.filters||[]),S(e.extra_filters||[])),o=_({},t,{form_data:_({},t.form_data,{filters:r})});l.a.get({endpoint:Object(p.d)(o.form_data,"json")}).then(function(e){var t=e.json,r=O[o.form_data.viz_type](o.form_data,t,n.props.onAddFilter,n.props.setTooltip,[],n.props.onSelect);n.setState({subSlicesLayers:_({},n.state.subSlicesLayers,P({},o.slice_id,r))})}).catch(function(){})})}},{key:"render",value:function(){var e=this.props,t=e.payload,r=e.formData,n=e.setControlValue,o=this.state.subSlicesLayers,a=Object.values(o);return i.a.createElement(s.a,{mapboxApiAccessToken:t.data.mapboxApiKey,viewport:this.state.viewport||this.props.viewport,onViewportChange:this.onViewportChange,layers:a,mapStyle:r.mapbox_style,setControlValue:n})}}])&&C(r.prototype,n),a&&C(r,a),t}();x.propTypes=A,x.defaultProps={onAddFilter:function(){},setTooltip:function(){},onSelect:function(){}};t.default=x},43:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return o}),r.d(t,"c",function(){return a}),r.d(t,"d",function(){return i}),r.d(t,"e",function(){return c}),r.d(t,"f",function(){return u});r(18);function n(e,t){for(var r=[],n=e;n<=t;n++)r.push([n,n.toString()]);return r}function o(e){return e.map(function(e){return[e,e.toString()]})}function a(e,t){return"".concat(e,"__").concat(t)}function i(e){var t=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),r=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}function c(e){var t;return e&&e.length>0&&(e.forEach(function(e){"count"===e.metric_name&&(t="count")}),t||(t=e[0].metric_name)),t}function u(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)}},496:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return o});var n=function(){var e=document.getElementById("app");if(!e)return[];var t=JSON.parse(e.getAttribute("data-bootstrap")),r=new Set([location.hostname]);return t&&t.common&&t.common.conf&&t.common.conf.SUPERSET_WEBSERVER_DOMAINS&&t.common.conf.SUPERSET_WEBSERVER_DOMAINS.forEach(function(e){r.add(e)}),Array.from(r)}(),o=n.length>1},935:function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return a});r(43);var n={longitude:6.85236157047845,latitude:31.222656842808707,zoom:1,bearing:0,pitch:0},o=1609.34;function a(e,t){return"square_m"===e?Math.sqrt(t/Math.PI):"radius_m"===e?t:"radius_km"===e?1e3*t:"radius_miles"===e?t*o:"square_km"===e?1e3*Math.sqrt(t/Math.PI):"square_miles"===e?Math.sqrt(t/Math.PI)*o:null}}}]);